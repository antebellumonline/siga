<!-- templates/alunos/aluno_list.html -->

{% extends 'base.html' %}

{% block title %}SIGA - Lista de Alunos{% endblock %}

{% block content %}
<h2 class="page-title">Lista de Alunos</h2>

<div class="container">
    <!-- Formulário de busca e filtro -->
    <form method="GET" action="{% url 'aluno_list' %}" class="search-form mb-4">
        <!-- Campos de pesquisa ocupando toda a div -->
        <div class="row mb-3">
            <div class="col mb-2">
                <input type="text" name="q" placeholder="Buscar por nome" value="{{ request.GET.q }}" class="form-control" aria-label="Buscar por nome">
            </div>
            <div class="col mb-2">
                <select name="cidade" class="form-control select2">
                    <option value="">Selecionar cidade</option>
                    <option value="São Paulo" {% if request.GET.cidade == "São Paulo" %}selected{% endif %}>São Paulo</option>
                    <option value="Rio de Janeiro" {% if request.GET.cidade == "Rio de Janeiro" %}selected{% endif %}>Rio de Janeiro</option>
                    <option value="Belo Horizonte" {% if request.GET.cidade == "Belo Horizonte" %}selected{% endif %}>Belo Horizonte</option>
                    <!-- Adicione mais opções de cidades aqui -->
                </select>
            </div>
        </div>

        <!-- Checkbox para mostrar inativos -->
        <div class="form-check mb-2">
            <input type="checkbox" name="inativo" value="True" class="form-check-input" {% if request.GET.inativo %}checked{% endif %}>
            <label class="form-check-label">Mostrar inativos</label>
        </div>

        <!-- Botões de ação centralizados -->
        <div class="button-container text-center mb-2">
            <button type="submit" class="btn btn-primary me-2">
                <i class="fas fa-search"></i> Buscar
            </button>
            <a href="{% url 'aluno_list' %}" class="btn btn-secondary">
                <i class="fas fa-times"></i> Limpar Filtros
            </a>
        </div>
    </form>

    <!-- Botão de Criar Aluno com ícone de "mais" -->
    <a href="{% url 'aluno_create' %}" class="btn btn-primary btn-create-aluno mt-3">
        <i class="fas fa-user-plus"></i> Criar Aluno
    </a>

    <!-- Tabela de alunos -->
    <table class="table table-striped table-bordered alunos-table">
        <thead class="table-dark">
            <tr>
                <th>
                    <a href="?order_by=uid{% if request.GET.descending %}&descending=False{% else %}&descending=True{% endif %}&q={{ request.GET.q }}&cidade={{ request.GET.cidade }}&inativo={{ request.GET.inativo }}">
                        UID {% if request.GET.order_by == 'uid' %}{% if request.GET.descending %}▼{% else %}▲{% endif %}{% endif %}
                    </a>
                </th>
                <th>
                    <a href="?order_by=nome{% if request.GET.descending %}&descending=False{% else %}&descending=True{% endif %}&q={{ request.GET.q }}&cidade={{ request.GET.cidade }}&inativo={{ request.GET.ativo }}">
                        Nome {% if request.GET.order_by == 'nome' %}{% if request.GET.descending %}▼{% else %}▲{% endif %}{% endif %}
                    </a>
                </th>
                <th>CPF</th>
                <th>Cidade</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for aluno in alunos %}
            <tr>
                <td>{{ aluno.uid }}</td>
                <td><a href="{% url 'aluno_detail' aluno.pk %}">{{ aluno.nome }}</a></td>
                <td>{{ aluno.cpf }}</td>
                <td>{{ aluno.cidade }}</td>
                <td>{{ aluno.inativo|yesno:"Inativo,Ativo" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5">Nenhum aluno encontrado.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>


{% endblock %}
