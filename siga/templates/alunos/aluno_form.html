<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Teste de Busca de CEP</title>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            console.log("JavaScript carregado e DOM pronto!");

            const cepInput = document.getElementById('cep');
            if (cepInput) {
                console.log("Campo CEP encontrado, adicionando evento blur");
                cepInput.addEventListener('blur', function() {
                    console.log("Evento blur acionado!");
                    buscaEndereco();
                });
            } else {
                console.log("Campo CEP não encontrado");
            }
        });

        function buscaEndereco() {
            var cep = document.getElementById("cep").value;
            console.log("CEP digitado:", cep); // Verifica o CEP digitado
            fetch(`/apis/buscacep/${cep}/`)  // Certifique-se de que a URL está correta
                .then(response => {
                    console.log("Resposta da API:", response); // Verifica a resposta da API
                    return response.json();
                })
                .then(data => {
                    console.log("Dados recebidos:", data); // Verifica os dados recebidos
                    if (data.resultado === "1") {
                        document.getElementById("logradouro").value = data.tipo_logradouro + " " + data.logradouro;
                        document.getElementById("bairro").value = data.bairro;
                        document.getElementById("cidade").value = data.cidade;
                    } else {
                        alert("CEP não encontrado!");
                    }
                })
                .catch(error => {
                    console.error("Erro na busca do CEP:", error); // Captura e exibe erros
                });
        }
    </script>
</head>
<body>
    <div>
        <label for="cep">CEP:</label>
        <input type="text" id="cep" name="cep">
    </div>
    <div>
        <label for="logradouro">Logradouro:</label>
        <input type="text" id="logradouro" name="logradouro">
    </div>
    <div>
        <label for="bairro">Bairro:</label>
        <input type="text" id="bairro" name="bairro">
    </div>
    <div>
        <label for="cidade">Cidade:</label>
        <input type="text" id="cidade" name="cidade">
    </div>
</body>
</html>
